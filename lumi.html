<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Lumi | Deep Dive Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Mermaid.js -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'dark' });
    </script>
    <style>
        body { font-family: 'Inter', system-ui, sans-serif; background-color: #111827; color: #E5E7EB; }
        .highlight { font-family: 'Courier New', monospace; background-color: #1F2937; color: #FDE68A; padding: 0.125rem 0.375rem; border-radius: 0.375rem; border: 1px solid #374151; }
        .code-block { background-color: #1E1E1E; border: 1px solid #374151; border-radius: 0.5rem; padding: 1.5rem; font-family: 'Courier New', monospace; overflow-x: auto; font-size: 0.875rem; line-height: 1.6; color: #abb2bf; }
        .keyword { color: #c678dd; } 
        .func { color: #61afef; } 
        .string { color: #98c379; } 
        .comment { color: #7f848e; font-style: italic; } 
        .tech-tag { display: inline-flex; align-items: center; padding: 0.25rem 0.75rem; background-color: #374151; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; color: #D1D5DB; margin-right: 0.5rem; margin-bottom: 0.5rem; }
    </style>
</head>
<body class="antialiased selection:bg-blue-500 selection:text-white">

    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="sticky top-0 z-50 bg-gray-900/90 backdrop-blur-md border-b border-gray-800">
        <div class="container mx-auto max-w-5xl px-4 h-16 flex items-center justify-between">
            <a href="index.html" class="text-gray-400 hover:text-white font-medium flex items-center transition-colors">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                Back to Home
            </a>
            <span class="text-xl font-bold text-white tracking-tight">Project Lumi</span>
        </div>
    </nav>

    <div class="container mx-auto max-w-5xl px-4 py-12">

        <!-- í—¤ë” ì„¹ì…˜ -->
        <header class="mb-16 text-center">
            <div class="flex justify-center flex-wrap mb-6">
                <span class="tech-tag border border-blue-500/30 text-blue-300">Local RAG</span>
                <span class="tech-tag border border-green-500/30 text-green-300">Windows Internals</span>
                <span class="tech-tag border border-purple-500/30 text-purple-300">Hybrid Architecture</span>
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-6 leading-tight">
                Lumi: OS ë³´ì•ˆ ê²½ê³„ë¥¼ ë„˜ëŠ”<br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">ì§€ëŠ¥í˜• ë¡œì»¬ íŒŒì¼ ì—ì´ì „íŠ¸</span>
            </h1>
            <p class="text-xl text-gray-400 max-w-3xl mx-auto leading-relaxed">
                "Python ê·œì¹™ ì—”ì§„ê³¼ LLM(Ollama)ì˜ í•˜ì´ë¸Œë¦¬ë“œ íŒŒì‹±ìœ¼ë¡œ <strong>í™˜ê° í˜„ìƒì„ ì œê±°</strong>í•˜ê³ ,<br>
                <strong>Windows Session 0 ê²©ë¦¬ ë¬¸ì œ</strong>ë¥¼ <code>ctypes</code> ì§ì ‘ í˜¸ì¶œ ì•„í‚¤í…ì²˜ë¡œ ê·¹ë³µí–ˆìŠµë‹ˆë‹¤."
            </p>
        </header>

        <!-- 0. ì‹œì—° ì˜ìƒ (Demo Video) - ì¶”ê°€ë¨ -->
        <section class="mb-20">
            <div class="flex items-center mb-8">
                <span class="bg-red-500 w-1.5 h-8 mr-4 rounded-full"></span>
                <h2 class="text-2xl font-bold text-white">Live Demo</h2>
            </div>
            
            <div class="bg-gray-800 rounded-xl overflow-hidden border border-gray-700 shadow-2xl relative">
                <!-- ìœˆë„ìš° UI ë°ì½”ë ˆì´ì…˜ -->
                <div class="bg-gray-900 px-4 py-3 border-b border-gray-700 flex items-center">
                    <div class="flex space-x-2 mr-4">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    </div>
                    <div class="text-xs text-gray-500 font-mono flex-1 text-center">lumi_demo.mp4</div>
                </div>

                <!-- ë¹„ë””ì˜¤ í”Œë ˆì´ì–´ -->
                <!-- playsinline: ëª¨ë°”ì¼ì—ì„œ ì „ì²´í™”ë©´ ë°©ì§€, preload: ë©”íƒ€ë°ì´í„° ë¯¸ë¦¬ ë¡œë“œ -->
                <video controls class="w-full bg-black aspect-video" preload="metadata" playsinline>
                    <!-- ì¤‘ìš”: assets í´ë”ì— íŒŒì¼ëª…ì´ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš” (ëŒ€ì†Œë¬¸ì êµ¬ë¶„) -->
                    <!-- ì½”ë± íŒŒë¼ë¯¸í„° ì¶”ê°€ (avc1.4d401eëŠ” ì¼ë°˜ì ì¸ H.264 í”„ë¡œíŒŒì¼) -->
                    <source src="assets/lumi_demo.mp4" type='video/mp4; codecs="avc1.4d401e, mp4a.40.2"'>
                    <source src="assets/lumi_demo.mp4" type="video/mp4">
                    
                    <!-- ì˜ìƒ ë¡œë“œ ì‹¤íŒ¨ ì‹œ í‘œì‹œë  ë‚´ìš© -->
                    <div class="p-10 text-center h-full flex flex-col justify-center items-center bg-gray-800">
                        <p class="text-gray-400 mb-4">ë¸Œë¼ìš°ì €ê°€ ë¹„ë””ì˜¤ íƒœê·¸ë¥¼ ì§€ì›í•˜ì§€ ì•Šê±°ë‚˜ ì˜ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                        <a href="assets/lumi_demo.mp4" class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors" target="_blank" download>
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            ì˜ìƒ íŒŒì¼ ì§ì ‘ ë‹¤ìš´ë¡œë“œ
                        </a>
                    </div>
                </video>
            </div>
            <p class="text-center text-gray-500 text-sm mt-4">
                * ì˜ìƒì´ ì¬ìƒë˜ì§€ ì•ŠëŠ” ê²½ìš°, <code>assets</code> í´ë”ì— <code>lumi_demo.mp4</code> íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”. (H.264 ì½”ë± ê¶Œì¥)
            </p>
        </section>

        <!-- 1. ì•„í‚¤í…ì²˜ ì§„í™” (Deep Research ê²°ê³¼ ë°˜ì˜) -->
        <section class="mb-20">
            <div class="flex items-center mb-8">
                <span class="bg-blue-600 w-1.5 h-8 mr-4 rounded-full"></span>
                <h2 class="text-2xl font-bold text-white">Architecture Evolution: From CLI to SDK</h2>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Before -->
                <div class="bg-gray-800/30 border border-red-900/30 rounded-xl p-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-red-900/50 text-red-200 text-xs px-3 py-1 rounded-bl-lg font-bold">Initial Attempt (Failed)</div>
                    <h3 class="text-lg font-bold text-white mb-4">Subprocess Approach</h3>
                    <div class="mermaid text-sm">
                        graph TD
                        A[Lumi (User Session)] -- subprocess --> B[es.exe (CLI)]
                        B -. IPC Fail .-> C[Everything Service (Session 0)]
                        style B fill:#3f1a1a,stroke:#7f1d1d
                        style C fill:#3f1a1a,stroke:#7f1d1d
                    </div>
                    <ul class="mt-4 space-y-2 text-sm text-gray-400">
                        <li class="flex items-start"><span class="text-red-500 mr-2">âœ—</span>Windows Session 0 ê²©ë¦¬ë¡œ ì¸í•´ IPC í†µì‹  ì°¨ë‹¨</li>
                        <li class="flex items-start"><span class="text-red-500 mr-2">âœ—</span>ì‚¬ìš©ì ê¶Œí•œ vs SYSTEM ê¶Œí•œ ì¶©ëŒ (Access Denied)</li>
                        <li class="flex items-start"><span class="text-red-500 mr-2">âœ—</span>"ì„œë¹„ìŠ¤ ì‹¤í–‰ ì¤‘ ì•„ë‹˜" í—ˆìœ„ ì˜¤ë¥˜ ë°œìƒ</li>
                    </ul>
                </div>

                <!-- After -->
                <div class="bg-gray-800/30 border border-green-900/30 rounded-xl p-6 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-green-900/50 text-green-200 text-xs px-3 py-1 rounded-bl-lg font-bold">Final Solution</div>
                    <h3 class="text-lg font-bold text-white mb-4">In-Process SDK Approach</h3>
                    <div class="mermaid text-sm">
                        graph TD
                        A[Lumi Backend] -- ctypes load --> B[Everything64.dll]
                        B -- Direct API --> C[Everything Engine]
                        style A fill:#064e3b,stroke:#059669
                        style B fill:#064e3b,stroke:#059669
                    </div>
                    <ul class="mt-4 space-y-2 text-sm text-gray-400">
                        <li class="flex items-start"><span class="text-green-500 mr-2">âœ“</span><strong>ctypes</strong>ë¡œ DLL ì§ì ‘ ë¡œë“œí•˜ì—¬ ë³´ì•ˆ ê²½ê³„ ìš°íšŒ</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">âœ“</span>ì™¸ë¶€ í”„ë¡œì„¸ìŠ¤ ì˜ì¡´ì„± ì œê±° (es.exe ë¶ˆí•„ìš”)</li>
                        <li class="flex items-start"><span class="text-green-500 mr-2">âœ“</span><strong>PyInstaller</strong>ë¡œ DLL ë²ˆë“¤ë§í•˜ì—¬ ì´ì‹ì„± í™•ë³´</li>
                    </ul>
                </div>
            </div>
            
            <div class="bg-blue-900/10 border border-blue-800 rounded-lg p-4">
                <p class="text-sm text-blue-200">
                    <strong>ğŸ’¡ AI Deep Research Insight:</strong> 
                    ë‹¨ìˆœí•œ ì½”ë“œ ì˜¤ë¥˜ê°€ ì•„ë‹ˆë¼ <strong>Windows Mandatory Integrity Control(MIC)</strong> ì •ì±…ì— ì˜í•œ ì°¨ë‹¨ì„ì„ AI ë¶„ì„ì„ í†µí•´ íŒŒì•…í–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ <code>subprocess</code> ë°©ì‹ì„ í¬ê¸°í•˜ê³  <code>ctypes</code> ê¸°ë°˜ì˜ DLL ì§ì ‘ í˜¸ì¶œ ë°©ì‹ìœ¼ë¡œ ì•„í‚¤í…ì²˜ë¥¼ ì „ë©´ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.
                </p>
            </div>
        </section>

        <!-- 2. ê¸°ìˆ ì  ë‚œê´€ ê·¹ë³µ (Troubleshooting Logs) -->
        <section class="mb-20">
            <div class="flex items-center mb-8">
                <span class="bg-purple-600 w-1.5 h-8 mr-4 rounded-full"></span>
                <h2 class="text-2xl font-bold text-white">Technical Challenges & Solutions</h2>
            </div>

            <div class="space-y-6">
                <!-- Case 1: DLL Dependency Hell -->
                <div class="bg-gray-800 rounded-xl overflow-hidden border border-gray-700">
                    <div class="p-6 border-b border-gray-700 bg-gray-800/50">
                        <h3 class="text-lg font-semibold text-white flex items-center">
                            <span class="bg-red-500/20 text-red-300 text-xs px-2 py-1 rounded mr-3">Packaging</span>
                            PyInstaller DLL Dependency Hell
                        </h3>
                    </div>
                    <div class="p-6 grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-sm font-bold text-gray-400 uppercase mb-2">Problem</h4>
                            <p class="text-gray-300 text-sm mb-4">
                                ê°œë°œ í™˜ê²½ì—ì„  ì‘ë™í•˜ë˜ <code>lumi_backend.exe</code>ê°€ ë°°í¬ í›„ <code>RuntimeError: Everything DLLì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</code> ì˜¤ë¥˜ì™€ í•¨ê»˜ ì¶©ëŒ.
                                <code>Everything64.dll</code>ë§Œ ë²ˆë“¤ë§í–ˆìœ¼ë‚˜, ë‚´ë¶€ì ìœ¼ë¡œ ì˜ì¡´í•˜ëŠ” C++ ëŸ°íƒ€ì„ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ëˆ„ë½ë¨.
                            </p>
                            <div class="bg-black/30 p-3 rounded text-xs font-mono text-red-400">
                                ImportError: DLL load failed: The specified module could not be found.
                            </div>
                        </div>
                        <div>
                            <h4 class="text-sm font-bold text-gray-400 uppercase mb-2">Solution</h4>
                            <p class="text-gray-300 text-sm mb-4">
                                ì‹œìŠ¤í…œ ê²½ë¡œ(<code>System32</code>)ì— ìˆëŠ” <code>VCRUNTIME140.dll</code>ê³¼ <code>MSVCP140.dll</code>ì„ ì°¾ì•„ PyInstaller ë°”ì´ë„ˆë¦¬ì— ëª…ì‹œì ìœ¼ë¡œ í¬í•¨ì‹œí‚¤ëŠ” <strong>Bundling Strategy</strong> ìˆ˜ë¦½.
                            </p>
                            <div class="code-block text-xs py-2">
<span class="comment"># lumi_backend.spec (Final)</span>
binaries=[
    ('bin/Everything64.dll', '.'),
    ('bin/VCRUNTIME140.dll', '.'), <span class="comment"># Critical Fix</span>
    ('bin/MSVCP140.dll', '.'),
],</div>
                        </div>
                    </div>
                </div>

                <!-- Case 2: Frontend Data Mismatch -->
                <div class="bg-gray-800 rounded-xl overflow-hidden border border-gray-700">
                    <div class="p-6 border-b border-gray-700 bg-gray-800/50">
                        <h3 class="text-lg font-semibold text-white flex items-center">
                            <span class="bg-yellow-500/20 text-yellow-300 text-xs px-2 py-1 rounded mr-3">Integration</span>
                            JSON Structure Mismatch (n.map is not a function)
                        </h3>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-300 text-sm mb-4">
                            ë°±ì—”ë“œê°€ <code>{"results": {"results": [...]}}</code> í˜•íƒœì˜ ì¤‘ì²© ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” ë°˜ë©´, í”„ë¡ íŠ¸ì—”ë“œëŠ” ë°°ì—´ì„ ê¸°ëŒ€í•˜ì—¬ <code>TypeError: n.map is not a function</code> ë°œìƒ.
                            <strong>Defensive Parsing</strong> ë¡œì§ì„ ë„ì…í•˜ì—¬ í•´ê²°.
                        </p>
                        <div class="code-block">
<span class="comment">// Frontend Fix (React)</span>
<span class="keyword">const</span> raw = data.results;
<span class="keyword">const</span> list = Array.isArray(raw) 
    ? raw 
    : Array.isArray(raw?.results) ? raw.results : []; <span class="comment">// ì´ì¤‘ êµ¬ì¡° ë° null ì•ˆì „ ì²˜ë¦¬</span>

setResults(list);</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. í•µì‹¬ ê¸°ëŠ¥: í•˜ì´ë¸Œë¦¬ë“œ íŒŒì‹± (Hybrid Parsing) -->
        <section class="mb-20">
            <div class="flex items-center mb-8">
                <span class="bg-blue-600 w-1.5 h-8 mr-4 rounded-full"></span>
                <h2 class="text-2xl font-bold text-white">Core Logic: Hybrid Intent Parsing</h2>
            </div>
            
            <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-8">
                <p class="text-gray-300 mb-6">
                    ì†Œí˜• LLM(Gemma:2b)ì˜ ë¬¸ë²• ì°½ì¡°(Hallucination) ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, 
                    <strong>Python ê·œì¹™ ì—”ì§„</strong>ì´ 1ì°¨ë¡œ ì˜ë„ë¥¼ ë¶„ì„í•˜ê³  ë³µì¡í•œ ìì—°ì–´ë§Œ LLMì—ê²Œ ìœ„ì„í•˜ëŠ” í•˜ì´ë¸Œë¦¬ë“œ ë¡œì§ì„ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.
                </p>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                    <!-- Mermaid Diagram -->
                    <div>
                        <div class="mermaid">
                            graph TD
                            A["ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥"] --> B{"Python Regex ë¶„ì„"}
                            B -- "íŒ¨í„´ ë§¤ì¹­ (ë¹ˆí´ë”, ìš©ëŸ‰)" --> C["Pythonì´ ì •ë ¬/ì¿¼ë¦¬ ìƒì„±<br>(Hallucination 0%)"]
                            B -- "ë³µì¡í•œ ìì—°ì–´" --> D["Local LLM (Gemma:2b)"]
                            D --> E["ì¿¼ë¦¬ ë²ˆì—­"]
                            C --> F["Everything DLL ì‹¤í–‰"]
                            E --> F
                            style C fill:#064e3b,stroke:#059669
                            style D fill:#7c2d12,stroke:#ea580c
                        </div>
                    </div>
                    <!-- Code Snippet -->
                    <div class="code-block">
<span class="comment"># services/search_service.py</span>
<span class="keyword">if</span> <span class="string">"ë¹ˆ í´ë”"</span> <span class="keyword">in</span> user_q:
    <span class="comment"># LLMì„ ê±°ì¹˜ì§€ ì•Šê³  Pythonì´ ì§ì ‘ ì²˜ë¦¬ (ì •í™•ë„ 100%)</span>
    query = <span class="string">f'"{path}" folder:childcount:0'</span>
<span class="keyword">elif</span> <span class="string">"ìš©ëŸ‰"</span> <span class="keyword">in</span> user_q:
    query = <span class="string">f'"{path}" file:'</span>
    sort_mode = <span class="string">6</span>  <span class="comment"># Size Descending ê°•ì œ ì ìš©</span>
<span class="keyword">else</span>:
    <span class="comment"># ê·œì¹™ì— ì—†ìœ¼ë©´ LLMì—ê²Œ ë²ˆì—­ ìš”ì²­ (Fallback)</span>
    query = <span class="keyword">await</span> ollama.ask(user_q)</div>
                </div>
            </div>
        </section>

        <!-- 4. ë°ëª¨ ë° ì„±ê³¼ -->
        <section>
            <div class="flex items-center mb-8">
                <span class="bg-gray-500 w-1.5 h-8 mr-4 rounded-full"></span>
                <h2 class="text-2xl font-bold text-white">Final Outcome</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 text-center">
                    <div class="text-3xl font-bold text-white mb-2">1s <span class="text-sm font-normal text-gray-400">lat</span></div>
                    <p class="text-gray-400 text-sm">Everything SDK ì§ì ‘ í˜¸ì¶œë¡œ ê²€ìƒ‰ ì§€ì—° ì‹œê°„ ìµœì†Œí™”</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 text-center">
                    <div class="text-3xl font-bold text-white mb-2">0% <span class="text-sm font-normal text-gray-400">Leak</span></div>
                    <p class="text-gray-400 text-sm">Local DLL & Gemma ëª¨ë¸ ì‚¬ìš©ìœ¼ë¡œ ë°ì´í„° ìœ ì¶œ ì›ì²œ ì°¨ë‹¨</p>
                </div>
                <div class="bg-gray-800 p-6 rounded-lg border border-gray-700 text-center">
                    <div class="text-3xl font-bold text-white mb-2">Portable</div>
                    <p class="text-gray-400 text-sm">PyInstaller + DLL Bundlingìœ¼ë¡œ ì„¤ì¹˜ ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥</p>
                </div>
            </div>
        </section>

    </div>

    <footer class="bg-gray-950 border-t border-gray-800 py-12 mt-20 text-center">
        <p class="text-gray-600 text-sm mb-2">Powered by Python, FastAPI, React, and Everything SDK</p>
        <p class="text-gray-500 text-xs">&copy; 2025 Kim Min-hyuk. Project Lumi.</p>
    </footer>

</body>
</html>
